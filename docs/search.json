[
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Monitoramento de frota de √¥nibus",
    "section": "",
    "text": "Mapeando a mobilidade urbana! Nesta atividade, constru√≠ um mapa interativo com as paradas de uma linha de √¥nibus e a posi√ß√£o em tempo real dos ve√≠culos.\n\nimport requests\nimport folium\nimport os\nfrom dotenv import load_dotenv\n\nload_dotenv()\nTOKEN = os.getenv(\"TOKEN_SPTRANS\")\nURL_BASE = \"https://api.olhovivo.sptrans.com.br/v2.1\"\n\nif not TOKEN:\n    raise ValueError(\"‚ùå Token SPTrans n√£o encontrado.\")\n\n# Cria uma sess√£o persistente\nsess = requests.Session()\n\n# 1Ô∏è‚É£ Autentica√ß√£o\nlogin_url = f\"{URL_BASE}/Login/Autenticar?token={TOKEN}\"\nauth = sess.post(login_url)\nif auth.status_code != 200 or auth.json() is not True:\n    raise Exception(f\"‚ùå Falha na autentica√ß√£o ({auth.status_code}): {auth.text}\")\nprint(\"‚úÖ Autentica√ß√£o bem-sucedida!\")\n\n# 2Ô∏è‚É£ Buscar a linha\nnumero_linha = \"875A-10\"\nbusca_linha_url = f\"{URL_BASE}/Linha/Buscar?termosBusca={numero_linha}\"\nresp_linha = sess.get(busca_linha_url)\nif resp_linha.status_code != 200 or not resp_linha.json():\n    raise Exception(f\"‚ùå Linha n√£o encontrada. Status: {resp_linha.status_code}\")\n\nlinha = resp_linha.json()[0]\ncodigo_linha = linha[\"cl\"]\nnome_linha = f\"{linha['lt']} - {linha['tp']}\"\nprint(f\"üöç Linha encontrada: {nome_linha} (C√≥digo {codigo_linha})\")\n\n# 3Ô∏è‚É£ Buscar paradas\nparadas_url = f\"{URL_BASE}/Parada/BuscarParadasPorLinha?codigoLinha={codigo_linha}\"\nresp_paradas = sess.get(paradas_url)\nparadas = resp_paradas.json()\n\nprint(f\"üìç {len(paradas)} paradas encontradas.\")\nlats = [p[\"py\"] for p in paradas]\nlons = [p[\"px\"] for p in paradas]\ncentro = (sum(lats)/len(lats), sum(lons)/len(lons))\nmapa = folium.Map(location=centro, zoom_start=12)\n\nfor p in paradas:\n    folium.Marker(\n        location=(p[\"py\"], p[\"px\"]),\n        popup=p[\"np\"],\n        icon=folium.Icon(color=\"blue\")\n    ).add_to(mapa)\n\n# 4Ô∏è‚É£ Posi√ß√µes em tempo real\nposicao_url = f\"{URL_BASE}/Posicao/Linha?codigoLinha={codigo_linha}\"\nresp_posicao = sess.get(posicao_url)\ndados = resp_posicao.json()\nveiculos = dados.get(\"vs\", [])\nprint(f\"üö¶ {len(veiculos)} ve√≠culos em tempo real.\")\n\nfor v in veiculos:\n    folium.Marker(\n        location=(v[\"py\"], v[\"px\"]),\n        popup=f\"Ve√≠culo: {v['p']}\",\n        icon=folium.Icon(color=\"red\")\n    ).add_to(mapa)\n\nmapa.save(\"mapa_875A10.html\")\nprint(\"üó∫Ô∏è Mapa salvo como mapa_875A10.html\")\n\n‚úÖ Autentica√ß√£o bem-sucedida!\nüöç Linha encontrada: 875A - PERDIZES (C√≥digo 609)\nüìç 7 paradas encontradas.\nüö¶ 0 ve√≠culos em tempo real.\nüó∫Ô∏è Mapa salvo como mapa_875A10.html"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "myblog",
    "section": "",
    "text": "Cota√ß√£o do D√≥lar\n\n\n\nAPI\n\ncode\n\n\n\n\n\n\n\n\n\nNov 20, 2025\n\n\nAnielly Miranda\n\n\n\n\n\n\n\n\n\n\n\n\nMonitoramento de frota de √¥nibus\n\n\n\ncode\n\nmonitoramento dos √¥nibus\n\n\n\n\n\n\n\n\n\nNov 20, 2025\n\n\nAnielly Miranda\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Cota√ß√£o do D√≥lar",
    "section": "",
    "text": "Explorando a cota√ß√£o do d√≥lar! Consulta a API do Banco Central.\nNesta atividade eu criei uma rotina em Python que consulta a cota√ß√£o do d√≥lar comercial em um determinado m√™s e ano, usando a API do Banco Central (PTAX) e exibe os resultados em um gr√°fico de linha interativo com o Plotly.\n\nInstalei as bibliotecas necess√°rias\n\nAntes de tudo, precisei instalar algumas bibliotecas que o c√≥digo utiliza:\n\npip install requests pandas plotly\n\nRequirement already satisfied: requests in /home/codespace/.local/lib/python3.12/site-packages (2.32.5)\nRequirement already satisfied: pandas in /home/codespace/.local/lib/python3.12/site-packages (2.3.3)\nRequirement already satisfied: plotly in /home/codespace/.local/lib/python3.12/site-packages (6.4.0)\nRequirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/codespace/.local/lib/python3.12/site-packages (from requests) (3.4.4)\nRequirement already satisfied: idna&lt;4,&gt;=2.5 in /home/codespace/.local/lib/python3.12/site-packages (from requests) (3.11)\nRequirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/codespace/.local/lib/python3.12/site-packages (from requests) (2.5.0)\nRequirement already satisfied: certifi&gt;=2017.4.17 in /home/codespace/.local/lib/python3.12/site-packages (from requests) (2025.10.5)\nRequirement already satisfied: numpy&gt;=1.26.0 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2.3.4)\nRequirement already satisfied: python-dateutil&gt;=2.8.2 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)\nRequirement already satisfied: pytz&gt;=2020.1 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2025.2)\nRequirement already satisfied: tzdata&gt;=2022.7 in /home/codespace/.local/lib/python3.12/site-packages (from pandas) (2025.2)\nRequirement already satisfied: narwhals&gt;=1.15.1 in /home/codespace/.local/lib/python3.12/site-packages (from plotly) (2.10.2)\nRequirement already satisfied: packaging in /home/codespace/.local/lib/python3.12/site-packages (from plotly) (25.0)\nRequirement already satisfied: six&gt;=1.5 in /home/codespace/.local/lib/python3.12/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)\nNote: you may need to restart the kernel to use updated packages.\n\n\nrequests ‚Üí para acessar a API do Banco Central\npandas ‚Üí para organizar os dados e tratar a tabela\nplotly ‚Üí para criar o gr√°fico de linha interativo\n\nFun√ß√£o principal\n\nDepois disso, criei uma fun√ß√£o chamada cotacao_dolar_periodo() que recebe uma string com o m√™s e o ano no formato ‚ÄúMMYYYY‚Äù, por exemplo ‚Äú082021‚Äù. A fun√ß√£o consulta as cota√ß√µes de todos os dias daquele m√™s e mostra o gr√°fico.\n\nimport requests\nimport pandas as pd\nimport calendar\nfrom datetime import datetime, timedelta\nimport plotly.express as px\n\ndef cotacao_dolar_periodo(mes_ano: str):\n    \"\"\"\n    Recebe uma string no formato 'MMYYYY' (ex: '082021') e retorna um gr√°fico de linha\n    com a cota√ß√£o do d√≥lar comercial (compra e venda) no per√≠odo.\n    \"\"\"\n    # Converter o texto para data e descobrir o primeiro e o √∫ltimo dia do m√™s\n    data_inicial = datetime.strptime(mes_ano, \"%m%Y\")\n    ultimo_dia = calendar.monthrange(data_inicial.year, data_inicial.month)[1]\n    data_final = data_inicial.replace(day=ultimo_dia)\n\n    # Ajustar o formato da data para o padr√£o da API (MM-DD-YYYY)\n    data_inicial_str = data_inicial.strftime(\"%m-%d-%Y\")\n    data_final_str = data_final.strftime(\"%m-%d-%Y\")\n\n    # URL da API do Banco Central (Cota√ß√£o do D√≥lar por Per√≠odo)\n    url = (\n        \"https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/\"\n        f\"CotacaoDolarPeriodo(dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?\"\n        f\"@dataInicial='{data_inicial_str}'&@dataFinalCotacao='{data_final_str}'&\"\n        \"$format=json&$select=cotacaoCompra,cotacaoVenda,dataHoraCotacao\"\n    )\n\n    # Fazer a requisi√ß√£o\n    response = requests.get(url)\n    if response.status_code != 200:\n        print(\"Erro ao acessar API do Banco Central.\")\n        return None\n\n    dados = response.json().get(\"value\", [])\n\n    # Converter o resultado em um DataFrame\n    df = pd.DataFrame(dados)\n    if df.empty:\n        print(\"Nenhum dado encontrado para o per√≠odo informado.\")\n        return None\n\n    # Converter a coluna de data e ordenar\n    df[\"dataHoraCotacao\"] = pd.to_datetime(df[\"dataHoraCotacao\"])\n    df = df.sort_values(\"dataHoraCotacao\")\n\n    # Preencher dias sem cota√ß√£o (feriados ou fins de semana) com o valor anterior\n    df = df.set_index(\"dataHoraCotacao\").asfreq(\"D\", method=\"ffill\").reset_index()\n\n    # Criar o gr√°fico com Plotly\n    fig = px.line(\n        df,\n        x=\"dataHoraCotacao\",\n        y=[\"cotacaoCompra\", \"cotacaoVenda\"],\n        title=f\"Cota√ß√£o do D√≥lar - {data_inicial.strftime('%B/%Y')}\",\n        labels={\n            \"dataHoraCotacao\": \"Data\",\n            \"value\": \"Cota√ß√£o (R$)\",\n            \"variable\": \"Tipo de Cota√ß√£o\"\n        }\n    )\n\n    # Ajustes visuais\n    fig.update_layout(\n        title_x=0.5,\n        legend_title_text=\"\",\n        template=\"plotly_white\"\n    )\n\n    # Exibir o gr√°fico\n    fig.show()\n\n\nExecutando o c√≥digo\n\nPara testar, basta chamar a fun√ß√£o passando o m√™s e o ano desejados:\n\ncotacao_dolar_periodo(\"082021\")\n\n                            \n                                            \n\n\nIsso vai gerar um gr√°fico interativo mostrando a varia√ß√£o da cota√ß√£o de compra e venda do d√≥lar ao longo de agosto de 2021.\n\nO que o c√≥digo faz automaticamente\n\nCalcula o primeiro e o √∫ltimo dia do m√™s informado.\nMonta a URL da API PTAX do Banco Central com essas datas.\nBusca as cota√ß√µes di√°rias de compra e venda.\nPreenche dias sem cota√ß√£o (como finais de semana e feriados) com o valor do dia anterior.\nCria um gr√°fico interativo com as duas linhas (compra e venda)."
  }
]